apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-kapt'

android {
  compileSdkVersion 26
  buildToolsVersion '26.0.2'
  useLibrary 'org.apache.http.legacy'

  defaultConfig {
    applicationId "pozzo.apps.travelweather"
    minSdkVersion 21
    targetSdkVersion 26
    versionCode 8
    versionName "1.0.8-snapshot"
    multiDexEnabled true
  }

  signingConfigs {
    release
  }

  allprojects {
    afterEvaluate { project ->
      def propsFile = rootProject.file("../../keystore/keystore.properties")
      def configName = 'release'

		def props = new Properties()
		props.load(new FileInputStream(propsFile))
		android.signingConfigs[configName].storeFile = file(props['storeFile'])
		android.signingConfigs[configName].storePassword = props['storePassword']
		android.signingConfigs[configName].keyAlias = props['keyAlias']
		android.signingConfigs[configName].keyPassword = props['keyPassword']
    }
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_7
    targetCompatibility JavaVersion.VERSION_1_7
  }

  buildTypes {
    release {
      debuggable false
      signingConfig signingConfigs.release
      minifyEnabled false
      proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
      project.ext.set('archivesBaseName', 'travelWeather-' + android.defaultConfig.versionName
      + '-' + android.defaultConfig.versionCode);
    }
    debug {
      debuggable true
      signingConfig signingConfigs.release
      minifyEnabled false
      proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
    }
  }

  sourceSets {
    test.java.srcDirs += 'src/test/kotlin'
  }

  dataBinding {
    enabled = true
  }
}

dependencies {
  //Google
  compile 'com.android.support:design:26.1.0'
  compile "android.arch.lifecycle:runtime:1.1.0"
  compile "android.arch.lifecycle:extensions:1.1.0"
  compile 'com.google.firebase:firebase-core:11.8.0'
  compile 'com.google.android.gms:play-services-maps:11.8.0'
  compile 'com.google.android.gms:play-services-location:11.8.0'
  kapt "android.arch.lifecycle:compiler:1.1.0"
  kapt "com.android.databinding:compiler:3.0.1"
  //Web requests
  compile 'com.squareup.retrofit2:retrofit:2.3.0'
  compile 'com.squareup.retrofit2:converter-gson:2.3.0'
  //Persistence
  compile 'com.michaelpardo:activeandroid:3.1.0-SNAPSHOT'
  //Mint
  compile "com.splunk.mint:mint:5.0.0"
  //Pozzo
  compile 'com.github.pozzoooo:pozzotools:-SNAPSHOT'
  //Kotlin
  compile "org.jetbrains.kotlin:kotlin-stdlib-jre7:$kotlinVersion"

  testCompile 'junit:junit:4.12'
}

apply plugin: 'com.google.gms.google-services'
